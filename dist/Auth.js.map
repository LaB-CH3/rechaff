{"version":3,"file":"Auth.js","sources":["../src/auth.js"],"sourcesContent":["class BaseAuth extends HTMLElement {\n  constructor(client, config, isLogin = false) {\n    super();\n    this.client = client;\n    this._config = config || {};\n    this.isLogin = isLogin;\n  }\n\n  set config(value) {\n    this._config = value || {};\n    this.render();\n  }\n  get config() {\n    return this._config;\n  }\n  get sharedStyles() {\n    return `\n      <style>\n        .sdk-form {\n          display: flex;\n          flex-direction: column;\n          gap: 18px;\n          width: 100%;\n          margin: 1rem auto;\n        }\n\n        .sdk-input {\n          width: 100%;\n          padding: 0.5rem .9rem;\n          border: 1px solid #e5e7eb;\n          border-radius: 0.5rem;\n          background-color: #ffffff;\n          outline: none;\n          transition: all 0.2s ease;\n          margin: 2px 0;\n        }\n        .sdk-input:focus {\n          border-color: #000000;\n          box-shadow: 0 0 0 4px #f3f4f6;\n        }\n\n        .sdk-button {\n          padding: 10px;\n          background: #222;\n          color: white;\n          border: none;\n          border-radius: 0.70rem;\n          cursor: pointer;\n          font-size: 16px;\n          margin: 6px 0;\n        }\n        .sdk-button:hover {\n          background: #000;\n        }\n\n        .sdk-oauth {\n          display: flex;\n          gap: 8px;\n          margin-top: 1rem;\n        }\n        .sdk-oauth-btn {\n          flex: 1;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 0.5rem;\n          border: 1px solid #e5e7eb;\n          padding: 0.5rem;\n          background-color: #ffffff;\n          border-radius: 0.70rem;\n          cursor: pointer;\n          transition: background-color 0.2s ease;\n        }\n        .sdk-oauth-btn:hover {\n          background-color: #f5f5f4;\n        }\n        .sdk-oauth-block {\n          flex-direction: column;\n        }\n\n        .sdk-error {\n          color: #991b1b;\n          font-size: 15px;\n          margin-top: 4px;\n        }\n\n        .sdk-divider {\n          display: flex;\n          align-items: center;\n          gap: 0.75rem; \n          color: #6b7280; \n          font-size: 1rem; \n          line-height: 1.5rem; \n          margin: 20px 0;\n        }\n        .sdk-divider span:first-child,\n        .sdk-divider span:last-child {\n          flex: 1;\n          border-bottom: 1px solid #e5e7eb; \n        }\n\n        .sdk-header {\n          display: flex;\n          flex-direction: column;\n          text-align: center;\n          margin: 10px 0 30px 0;\n        }\n        .sdk-header h1 {\n          font-size: 1.5rem;\n          font-weight: 500;\n          margin: 0;\n          line-height: 2rem;\n        }\n        .sdk-header p {\n          font-size: 0.875rem;\n          color: #6b7280;\n          line-height: 1.25rem;\n        }\n        .sdk-header img {\n          margin: 5px auto;\n        }\n\n        .sdk-password-label{\n           display: flex;\n           justify-content: space-between;\n        }\n      \n      </style>\n    `;\n  }\n\n\n  connectedCallback() {\n    if (this.hasAttribute(\"config\")) {\n      try {\n        this._config = JSON.parse(this.getAttribute(\"config\"));\n      } catch (e) {\n        console.warn(\"Invalid config JSON\", e);\n      }\n    }\n    this.render();\n    this.attachListeners();\n  }\n\n  renderHeader() {\n    const { assets = {} } = this._config;\n    return `\n      <div class=\"sdk-header\">\n        ${assets?.logoImageUrl \n          ? `<a href=\"${assets?.logoLinkUrl || \"#\"}\"><img src=\"${assets?.logoImageUrl}\" height=\"40\"/></a>` \n          : ``}\n        <h1>${assets?.title || ''}</h1>\n        <p>${assets?.subtitle || ''}</p>\n      </div>\n    `;\n  }\n\n  renderOAuthButtons(variant, elements) {\n    const providers = this._config.providers || [];\n    return `\n      <div class=\"sdk-oauth ${variant == 'blockButton' ? 'sdk-oauth-block' : ''}\">\n        ${providers.map(p =>\n          `<button class=\"sdk-oauth-btn ${elements.providersButton || ''}\" data-provider=\"${p}\">\n            <i class=\"ri-${p.toLowerCase()}-fill\"></i> ${variant === \"iconButton\" ? p : `Continue with ${p}`}\n          </button>`\n        ).join(\"\")}\n      </div>\n    `;\n  }\n\n  renderDivider(providers) {\n    if(!providers || providers?.length == 0) return ''\n    return `\n     <div class=\"sdk-divider\">\n      <span></span>  <span>or continue with</span> <span></span>\n     </div>\n    `;\n  }\n\n\n  \n  renderAuthForm(authType){\n     const { elements = {}, layout = {}, assets = {} } = this._config;\n     const socialPlacement = layout.socialButtonsPlacement || \"bottom\";\n     const socialVariant = layout.socialButtonsVariant || \"blockButton\";\n     const providers = this._config.providers || [];\n\n\n     return `\n     ${socialPlacement === \"top\" ? `${this.renderOAuthButtons(socialVariant, elements)} ${this.renderDivider(providers)}` : \"\"}\n      <form id=\"sdk-form\" class=\"sdk-form\">\n         ${authType == 'up' ? `\n          <div>\n            <label for=\"sdk-form-name\">Full name</label>\n            <input id=\"sdk-form-name\" class=\"sdk-input ${elements.formInputs || ''}\" type=\"text\" name=\"name\" autocomplete=\"given-name\" placeholder=\"Jackie Robinson\" required />\n          </div>\n          ` : '' }\n        <div>\n          <label for=\"sdk-form-email\">Email address</label>\n          <input id=\"sdk-form-email\" class=\"sdk-input ${elements.formInputs || ''}\" type=\"email\" name=\"email\" autocomplete=\"off\" placeholder=\"email@address.com\" required />\n        </div>\n        <div>\n          <label for=\"sdk-form-password\">Password</label>\n          <input id=\"sdk-form-password\" class=\"sdk-input ${elements.formInputs || ''}\" type=\"password\" name=\"password\" placeholder=\"Enter your password\" required />\n          <div class=\"sdk-error\"></div>\n        </div>\n\n        <button class=\"sdk-button ${elements.formButtonPrimary || ''}\" type=\"submit\">Sign ${authType}</button>\n      </form>\n      ${socialPlacement === \"bottom\" ? `${this.renderDivider(providers)} ${this.renderOAuthButtons(socialVariant, elements)}` : \"\"}\n     `\n  }\n\n  attachListeners() {\n    const form = this.querySelector(\"#sdk-form\");\n    const errorBox = this.querySelector(\".sdk-error\");\n\n    form.addEventListener(\"submit\", async (e) => {\n      e.preventDefault();\n\n      const email = this.querySelector('input[name=\"email\"]')?.value || '';\n      const password = this.querySelector('input[name=\"password\"]')?.value || '';\n      const display_name = this.querySelector('input[name=\"name\"]')?.value || '';\n      \n      const { error, data } = this.isLogin\n        ? await this.client.auth.signInWithPassword({ email, password })\n        : await this.client.auth.signUp({\n            email,\n            password,\n            options: { data: { display_name } },\n          });\n\n       if (error) {\n          return errorBox.innerHTML = `<i class=\"ri-error-warning-line\"></i> ${error.message || \"Invalid credentials\"}`\n        } \n        const redirectUrl = this._config.assets?.redirectUrl || \"/\";\n        window.location.href = redirectUrl;\n    }); \n    \n\n\n    const buttons = Array.from(this.querySelectorAll(\".sdk-oauth button\"));\n    buttons.forEach((btn) =>\n      btn.addEventListener(\"click\", async () => {\n        const provider = btn.dataset.provider.toLowerCase();\n        await this.client.auth.signInWithOAuth({\n          provider,\n          options: { redirectTo: this._config.assets?.redirectUrl || \"/\" },\n        });\n      })\n    );\n  }\n}\n\n\n\n\nclass SignIn extends BaseAuth {\n   constructor(client, config) {\n    super(client, config, true); // login\n  }\n\n  render() {\n    this.innerHTML = `\n      ${this.sharedStyles}\n      ${this.renderHeader()}\n      ${this.renderAuthForm('in')}\n    `;\n  }\n}\n\n\n\n\nclass SignUp extends BaseAuth {\n   constructor(client, config) {\n    super(client, config, false); // signup\n  }\n\n  render() {\n    this.innerHTML = `\n      ${this.sharedStyles}\n      ${this.renderHeader()}\n      ${this.renderAuthForm('up')}\n    `;\n  }\n}\n\n\n\nexport function createAuthComponents(client) {\n  if (!customElements.get(\"supabase-signin\")) {\n    customElements.define(\"supabase-signin\", class extends SignIn { constructor() { super(client); } });\n  }\n  if (!customElements.get(\"supabase-signup\")) {\n    customElements.define(\"supabase-signup\", class extends SignUp { constructor() { super(client); } });\n  }\n  return { SignIn: \"supabase-signin\", SignUp: \"supabase-signup\" };\n}\n\n\n"],"names":["BaseAuth","client","config","isLogin","value","assets","variant","elements","providers","p","authType","layout","socialPlacement","socialVariant","form","errorBox","e","email","password","display_name","error","data","redirectUrl","btn","provider","SignIn","SignUp","createAuthComponents"],"mappings":"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"}